# Synthetic Stock Data Generation using Conditional GANs

## Project Overview

This project utilizes a Conditional Generative Adversarial Network (CGAN) to generate synthetic stock data, specifically the closing prices. The choice of a CGAN allows the model to generate stock data conditioned on specific attributes, in this case, the volatility of the stock data.

## Data Collection and Preprocessing

1. **Fetching Stock Data**: Data for a given ticker (e.g., AAPL) is fetched for a period of two years using the `yfinance` library.

2. **Preprocessing**:
    - The raw stock closing prices are scaled using MinMax scaling.
    - The volatility of the stock data, computed as the rolling standard deviation, is also scaled using MinMax scaling.

This preprocessing step ensures the data is in a suitable range for the neural network training and also prepares volatility as a condition for the CGAN.

## Conditional GAN Architecture

### Generator

The generator is designed to generate synthetic stock data. It takes in random noise along with the scaled volatility as a condition to produce the synthetic stock closing prices.

1. **Input**: Concatenation of noise and the condition (volatility).
2. **Architecture**:
    - Fully connected layers with Batch Normalization and Dropout.
    - LeakyReLU activation functions are used, with a linear activation at the output layer.

### Discriminator

The discriminator tries to distinguish between real stock data and the synthetic data generated by the generator.

1. **Input**: Real or synthetic stock data concatenated with the condition (volatility).
2. **Architecture**:
    - Fully connected layers with Dropout.
    - LeakyReLU activation functions are used.

### Loss Functions and Optimizers

- The discriminator uses binary cross-entropy loss, comparing its predictions on real data to an array of ones and its predictions on fake (synthetic) data to an array of zeros.
  
- The generator’s loss function is a composite of multiple components:
    1. Main Loss: Binary cross-entropy loss on discriminator’s predictions of the generated data.
    2. Temporal Difference: Measures the difference between consecutive points in the generated and real stock data.
    3. Mean Squared Error (MSE): Measures the mean squared differences between consecutive points in the generated stock data.
    4. Variance Loss: Ensures the variance of the generated data matches the variance of the real data.

### Training

The CGAN is trained iteratively with the generator and discriminator competing against each other. The generator aims to produce stock data so realistic that the discriminator can't tell it's fake, while the discriminator tries to get better at distinguishing real data from fake.

During training:
- Generator creates synthetic stock data.
- Discriminator tries to distinguish this synthetic data from the real stock data.
- Both models are updated based on their performance.

## Post-processing and Synthetic Data Generation

1. **Synthetic Data Generation**: After training, the generator is utilized to generate synthetic stock data conditioned on the scaled volatilities of the original stock data.

2. **Post-processing**: The synthetic stock data generated by the model is then rescaled back to the original data's scale using the inverse of the MinMax scaling applied during preprocessing.

## Visualization

Post-training, the generator and discriminator losses over the epochs are visualized to assess the training process.




## Conclusion

The project effectively leverages the power of Conditional GANs to produce synthetic stock data, which could be valuable for various financial analytics, back-testing trading strategies, or simulating diverse market conditions.
